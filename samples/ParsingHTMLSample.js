PostConversion.Trace('Test DOM');
var DOM = new ActiveXObject('htmlfile');
var html = "\r\n<!DOCTYPE html>\r\n<html xmlns:MadCap=\"http:\/\/www.madcapsoftware.com\/Schemas\/MadCap.xsd\" lang=\"en-us\" xml:lang=\"en-us\" data-mc-search-type=\"Stem\" data-mc-help-system-file-name=\"help.xml\" data-mc-path-to-help-system=\"\" data-mc-has-content-body=\"True\" data-mc-target-type=\"WebHelp2\" data-mc-runtime-file-type=\"Topic;Default\" data-mc-preload-images=\"false\" data-mc-in-preview-mode=\"false\" data-mc-toc-path=\"User Guide|Create Views and Dashboards|The Web Authoring Workspace|Calculated Fields\">\r\n    <!-- saved from url=(0016)http:\/\/localhost -->\r\n    <head>\r\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" \/>\r\n        <meta charset=\"utf-8\" \/>\r\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" \/>\r\n        <meta http-equiv=\"Content-Type\" content=\"text\/html; charset=utf-8\" \/><title>Ad-Hoc Calculations<\/title>\r\n        <!-- Do not translate \"section\" and \"subsection\" -->\r\n        <meta name=\"section\" content=\"Support\" \/>\r\n        <meta name=\"subsection\" content=\"Product Help\" \/>\r\n        <!-- End of section not to translate -->\r\n        <meta name=\"breadcrumb_l1_text\" content=\"Support\" \/>\r\n        <meta name=\"breadcrumb_l1_url\" content=\"http:\/\/www.tableau.com\/en-us\/support\" \/>\r\n        <meta name=\"breadcrumb_l2_text\" content=\"Product Help\" \/>\r\n        <meta name=\"breadcrumb_l2_url\" content=\"http:\/\/www.tableau.com\/en-us\/support\/help\" \/>\r\n        <!-- Google Tag Manager -->\r\n        <script type=\"text\/javascript\">\/* <![CDATA[ *\/(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\r\n\t\t\tnew Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\r\n\t\t\tj=d.createElement(s),dl=l!='dataLayer'?String.fromCharCode(38)+'l='+l:'';j.async=true;j.src=\r\n\t\t\t'\/\/www.googletagmanager.com\/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\r\n\t\t})(window,document,'script','dataLayer','GTM-BVCN');\/* ]]> *\/<\/script>\r\n        <!-- End Google Tag Manager -->\r\n        <link href=\"Skins\/Default\/Stylesheets\/Slideshow.css\" rel=\"stylesheet\" data-mc-generated=\"True\" \/>\r\n        <link href=\"Skins\/Default\/Stylesheets\/TextEffects.css\" rel=\"stylesheet\" data-mc-generated=\"True\" \/>\r\n        <link href=\"Skins\/Default\/Stylesheets\/Topic.css\" rel=\"stylesheet\" data-mc-generated=\"True\" \/>\r\n        <link href=\"Skins\/Default\/Stylesheets\/Components\/Styles.css\" rel=\"stylesheet\" data-mc-generated=\"True\" \/>\r\n        <link href=\"Skins\/Default\/Stylesheets\/Components\/Tablet.css\" rel=\"stylesheet\" data-mc-generated=\"True\" \/>\r\n        <link href=\"Skins\/Default\/Stylesheets\/Components\/Mobile.css\" rel=\"stylesheet\" data-mc-generated=\"True\" \/>\r\n        <link href=\"Skins\/Fluid\/Stylesheets\/foundation.5.5.0.css\" rel=\"stylesheet\" data-mc-generated=\"True\" \/>\r\n        <link href=\"Skins\/Fluid\/Stylesheets\/Styles.css\" rel=\"stylesheet\" data-mc-generated=\"True\" \/>\r\n        <link href=\"Skins\/Fluid\/Stylesheets\/Tablet.css\" rel=\"stylesheet\" data-mc-generated=\"True\" \/>\r\n        <link href=\"Skins\/Fluid\/Stylesheets\/Mobile.css\" rel=\"stylesheet\" data-mc-generated=\"True\" \/>\r\n        <link href=\"Resources\/TableStyles\/Basic-Border.css\" rel=\"stylesheet\" \/>\r\n        <link href=\"Resources\/Stylesheets\/top-nav.css\" rel=\"stylesheet\" \/>\r\n        <script src=\"Resources\/Scripts\/custom.modernizr.js\">\r\n        <\/script>\r\n        <script src=\"Resources\/Scripts\/jquery.min.js\">\r\n        <\/script>\r\n        <script src=\"Resources\/Scripts\/require.min.js\">\r\n        <\/script>\r\n        <script src=\"Resources\/Scripts\/require.config.js\">\r\n        <\/script>\r\n        <script src=\"Resources\/Scripts\/foundation.5.5.0_custom.js\">\r\n        <\/script>\r\n        <script src=\"Resources\/Scripts\/foundation.offcanvas.js\">\r\n        <\/script>\r\n        <script src=\"Resources\/Scripts\/plugins.min.js\">\r\n        <\/script>\r\n        <script src=\"Resources\/Scripts\/MadCapAll.js\">\r\n        <\/script>\r\n        <script src=\"Resources\/Code\/sideMenu.js\">\r\n        <\/script>\r\n    <\/head>\r\n    <body>\r\n        <div class=\"foundation-wrap\">\r\n            <div class=\"off-canvas-wrap\" data-offcanvas=\"\">\r\n                <section class=\"inner-wrap\">\r\n                    <nav class=\"tab-bar\" data-mc-ignore=\"true\">\r\n                        <section class=\"middle tab-bar-section row outer-row clearfix\">\r\n                            <div class=\"relative clearfix\"><a class=\"logo\" href=\"http:\/\/www.tableau.com\/support\/help\" alt=\"Logo\"><\/a>\r\n                                <div class=\"navigation-wrapper\">\r\n                                    <ul class=\"navigation clearfix\">\r\n                                        <li class=\"has-children\"><a href=\"get_started_server.htm\">Get Started with Tableau Server<\/a>\r\n                                            <ul class=\"sub-menu\">\r\n                                                <li><a href=\"welcome.htm\">Welcome to Tableau Server<\/a>\r\n                                                <\/li>\r\n                                                <li><a href=\"whatsnew_server.htm\">What's New in Tableau Server<\/a>\r\n                                                <\/li>\r\n                                                <li><a href=\"server-desktop-web-edit-differences.htm\">Web Authoring and Tableau Desktop Comparison<\/a>\r\n                                                <\/li>\r\n                                                <li><a href=\"dev_resources.htm\">Developer Resources<\/a>\r\n                                                <\/li>\r\n                                                <li><a href=\"quickstarts.html\">Quick Starts<\/a>\r\n                                                <\/li>\r\n                                                <li><a href=\"copyright.htm\">Copyright<\/a>\r\n                                                <\/li>\r\n                                            <\/ul>\r\n                                        <\/li>\r\n                                        <li class=\"has-children\"><a href=\"lp_webclient.htm\">User Guide<\/a>\r\n                                            <ul class=\"sub-menu\">\r\n                                                <li class=\"has-children\"><a href=\"browse.htm\">Get Around<\/a>\r\n                                                    <ul class=\"sub-menu\">\r\n                                                        <li><a href=\"logon.htm\">Sign In<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"navigating.htm\">Navigate Tableau Server<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"sites_navigate.htm\">Multi-Site Navigation<\/a>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"find_content.htm\">Discover and Find Content<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"qs_universal_search.htm\">Quick Start:&#160;Quick Search for Tableau Server<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"qs_content_discovery_analytics.html\">Quick Start:&#160;Discover Popular Content<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"view_content.htm\">View, Sort, and Select Content<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"search.htm\">Search Content<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"favorites.htm\">Store Favorites<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"qs_content_page.html\">Access and Manage Your Content<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                    <\/ul>\r\n                                                <\/li>\r\n                                                <li class=\"has-children\"><a href=\"views_manage.htm\">Interact with Views<\/a>\r\n                                                    <ul class=\"sub-menu\">\r\n                                                        <li><a href=\"shareworkbooks.htm\">Share Views<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"export.htm\">Download Views or Workbooks<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"subscribe_user.htm\">Subscribe to Views<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"tags.htm\">Tag Content<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"refresh.htm\">Refresh Data or Pause Updates<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"sort.htm\">Sort Data<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"filter.htm\">Filter Data<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"maps_explore.htm\">Explore Data in Maps<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"viewdata.htm\">Explore Data via Tooltips<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"hyperlinks.htm\">Follow Hyperlinks<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"highlight.htm\">Highlight Marks, Legends and Actions<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"comment.htm\">Comment on Views<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"qs_custom_views.html\">Quick Start:&#160;Custom Views<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"customview.htm\">Use Custom Views<\/a>\r\n                                                        <\/li>\r\n                                                    <\/ul>\r\n                                                <\/li>\r\n                                                <li class=\"has-children\"><a href=\"web_author.htm\">Create Views and Dashboards<\/a>\r\n                                                    <ul class=\"sub-menu\">\r\n                                                        <li><a href=\"datasource_using.htm\">Connect to Published Data Sources<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"web_author_build_view.htm\">Build Views<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"qs_revision_history.html\">Quick Start: Keep Content Revisions<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"revision_history_actions.htm\">Work with Content Revisions<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"dashboards_best_practices.htm\">Best Practices for Effective Dashboards<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"dashboards_create.htm\">Create a Dashboard<\/a>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"dashboards_refine.htm\">Refine Your Dashboard<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"dashboards_organize_floatingandtiled.htm\">Size and Lay Out Your Dashboard<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"web_author_environment.htm\">The Web Authoring Workspace<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"web_author_toolbar.htm\">Web Edit Toolbar<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"environ_side_bar.htm\">The Side Bar<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"web_author_columns_rows.htm\">Columns and Rows Shelves<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"viewparts_marks.htm\">Marks Card<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"web_author_filters_shelf.htm\">Filters Shelf<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"web_author_pages_shelf.htm\">Pages Shelf<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"web_author_tooltips.htm\">Tooltips<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"calculations_calculatedfields.htm\">Calculated Fields<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"calculations_tablecalculations.htm\">Transform Values with Table Calculations<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"reference_lines.htm\">Reference Lines and Bands<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                    <\/ul>\r\n                                                <\/li>\r\n                                                <li class=\"has-children\"><a href=\"embed.htm\">Embed Views and Dashboards<\/a>\r\n                                                    <ul class=\"sub-menu\">\r\n                                                        <li><a href=\"embed_code.htm\">Writing Embed Code<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"embed_list.htm\">Parameters for Embed Code<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"embed_filter_add.htm\">Add Filters to Embed Code<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"embed_structure.htm\">How View URLs Are Structured<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"embed_loadorder.htm\">Control Load Order for Multiple Embedded Views<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"embed_dashboard.htm\">Embed Dashboards<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"embed_code_custom_view.htm\">Embed Code for Custom Views<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"embed_ex_wiki.htm\">Embed Views into Wikis<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"embed_ex_img.htm\">Embed Images<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"embed_ex_SP.htm\">Embed Views into SharePoint (Microsoft SSPI)<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"embed_ex_trustedauth.htm\">Embed Views into SharePoint (Local Authentication)<\/a>\r\n                                                        <\/li>\r\n                                                    <\/ul>\r\n                                                <\/li>\r\n                                                <li class=\"has-children\"><a href=\"manage_user_settings.htm\">Manage Your User Settings<\/a>\r\n                                                    <ul class=\"sub-menu\">\r\n                                                        <li><a href=\"useracct.htm\">Change Your Account Settings<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"savingpwds.htm\">Save Passwords for Database Access<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"manage_stored_credentials.htm\">Manage OAuth Credentials<\/a>\r\n                                                        <\/li>\r\n                                                    <\/ul>\r\n                                                <\/li>\r\n                                            <\/ul>\r\n                                        <\/li>\r\n                                        <li class=\"has-children\"><a href=\"sites.htm\">Site Administrator Guide<\/a>\r\n                                            <ul class=\"sub-menu\">\r\n                                                <li><a href=\"navigate_siteadmin_pages.htm\">Navigate Site Admin Pages<\/a>\r\n                                                <\/li>\r\n                                                <li><a href=\"site_admin_planning.htm\">Planning a Site<\/a>\r\n                                                <\/li>\r\n                                                <li class=\"has-children\"><a href=\"users.htm\">Create Users and Groups<\/a>\r\n                                                    <ul class=\"sub-menu\">\r\n                                                        <li><a href=\"sites_addusers.htm\">Add Users to a Site<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"users_site_roles.htm\">Set Users' Site Roles<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"users_site_membership.htm\">Assign Site Membership<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"users_guest.htm\">Enable Guest Access<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"users_import.htm\">Import Users<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"csvguidelines.htm\">CSV Import File Guidelines<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"users_view.htm\">View, Edit, and Delete Users<\/a>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"groups.htm\">About Groups<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"users_add_group.htm\">Add Users to a Group<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"groups_create_local.htm\">Create a Local Group<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"groups_create_ad.htm\">Create a Group via Active Directory<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"groups_delete.htm\">Delete Groups<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                    <\/ul>\r\n                                                <\/li>\r\n                                                <li class=\"has-children\"><a href=\"projects.htm\">Create Projects to Organize Content<\/a>\r\n                                                    <ul class=\"sub-menu\">\r\n                                                        <li><a href=\"projects_add.htm\">Add Projects<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"projects_move.htm\">Move Workbooks into Projects<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"projects_delete.htm\">Delete Projects<\/a>\r\n                                                        <\/li>\r\n                                                    <\/ul>\r\n                                                <\/li>\r\n                                                <li class=\"has-children\"><a href=\"permissions.htm\">Content Access and Ownership<\/a>\r\n                                                    <ul class=\"sub-menu\">\r\n                                                        <li><a href=\"permissions_view.htm\">View and Edit Permission Rules<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"owner.htm\">Manage Content Ownership<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"license_permissions_backgrnd.htm\">How Permissions are Evaluated<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"qs_permissions.html\">Quick Start:&#160;Set Up Permissions<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"permissions_projectbased.htm\">Create Project-Based Permissions<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"permissions_project_defaults.htm\">Set Default Permissions for a Project, and its Workbooks and Data Sources<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"projects_perm.htm\">Set Permissions for a Project<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"qs_control_project_permissions.html\">Quick Start:&#160;Lock Project Permissions<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"permissions_project_lock.htm\">Lock Content Permissions to the Project<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"datasource_perm_set.htm\">Set Permissions for a Data Source<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"permissions_set.htm\">Set Permissions for Workbooks and Views<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"web_author_who.htm\">Grant Edit and Save Permissions<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"license_permissions.htm\">Permissions Reference<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"web_author_enable.htm\">Set a Site's Web Authoring Access<\/a>\r\n                                                        <\/li>\r\n                                                    <\/ul>\r\n                                                <\/li>\r\n                                                <li class=\"has-children\"><a href=\"datasource.htm\">Manage Data<\/a>\r\n                                                    <ul class=\"sub-menu\">\r\n                                                        <li><a href=\"datasource_view_attributes.htm\">View Data Source Attributes<\/a>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"schedules.htm\">Keep Data Fresh<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"publish.htm\">About Extracts and Schedules<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"task.htm\">Manage Refresh Tasks<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"schedule_manage_create.htm\">Create or Modify a Schedule<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"schedule_add.htm\">Add a Workbook or Data Source to an Extract Schedule<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"qs_incremental_extracts.html\">Quick Start: Manage Incremental Extracts<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"qs_refresh_extracts.html\">Quick Start: Refresh Extracts on a Schedule<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"extract_refresh.htm\">Automate Refresh Tasks<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"extract_refresh_alert.htm\">Handle Extract Refresh Alerts<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"task_prioritization.htm\">How Scheduled Tasks are Prioritized<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"connections_modify.htm\">Edit Connections<\/a>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"datasource_cube.htm\">Cube Data Sources<\/a>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"datasource_wdc.htm\">Web Data Connectors<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"datasource_wdc_vetting.htm\">Vetting Web Data Connectors<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                    <\/ul>\r\n                                                <\/li>\r\n                                            <\/ul>\r\n                                        <\/li>\r\n                                        <li class=\"has-children\"><a href=\"admin.htm\">Server Administrator Guide<\/a>\r\n                                            <ul class=\"sub-menu\">\r\n                                                <li class=\"has-children\"><a href=\"topic_list_plan_deploy.htm\">Planning &amp; Deployment<\/a>\r\n                                                    <ul class=\"sub-menu\">\r\n                                                        <li class=\"has-children\"><a href=\"requ.htm\">Before You Install<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"server_hardware_min.htm\">Minimum Hardware Requirements and Recommendations<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"runas_domain.htm\">Domain Trust Requirements<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"runas.htm\">Run As User<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"proxy.htm\">Configuring Proxies for Tableau Server<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"install.htm\">Install and Configure<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"setup.htm\">Run Server Setup<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"activate.htm\">Activate Tableau<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"config.htm\">Tableau Server Configuration Utility<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"startup.htm\">Add an Administrator Account<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"server_install_unattended.htm\">Automated Install<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"reconfig.htm\">Reconfigure the Server<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"navigate_serveradmin_pages.htm\">Navigate Server Admin Pages<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"users_add.htm\">Add Users to the Server<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"schedule_enable.htm\">Enable Extract Refresh Scheduling and Failure Notification<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"subscribe.htm\">Set Up Subscriptions<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"server_move_location.htm\">Move Tableau Server to Another Drive<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"upgrade.htm\">Upgrade Tableau Server<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"sug_plan.htm\">Research the Upgrade<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"upgrade_pre.htm\">Prepare for the Upgrade<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"sug_test.htm\">Test the Upgrade<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"upgrade_samehrdwr.htm\">Perform the Upgrade<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"sug_special.htm\">Special Installation Situations<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"trouble_install_upgrade.htm\">Troubleshoot Install and Upgrade<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"distrib.htm\">Distributed Environments<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"qs_distributed_server.html\">Quick Start:&#160;Distributed Server<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"distrib_requ.htm\">Distributed Requirements<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"distrib_setup.htm\">Install and Configure Worker Nodes<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"distrib_maint.htm\">Maintain a Distributed Environment<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"distrib_ha.htm\">High Availability<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"deployment_resources.htm\">More Deployment Resources<\/a>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"license_server_overview.htm\">Manage Licensing<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"view_licenses.htm\">View Server Licenses<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"license_refresh.htm\">Refresh Maintenance Date for the Product Key<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"capacity_add.htm\">Add Capacity<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"license_automating.htm\">Automate Licensing Tasks<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"sites_intro.htm\">Work with Sites<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"sites_add.htm\">Add or Edit Sites<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"sites_exportimport.htm\">Import or Export a Site<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"sites_delete.htm\">Delete Sites<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"sites_availability.htm\">Site Availability<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"revision_history_maintain.htm\">Enable&#160;Users to Save Revision History<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"customize.htm\">Customize your Site<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                    <\/ul>\r\n                                                <\/li>\r\n                                                <li class=\"has-children\"><a href=\"topic_list_tuning_ops.htm\">Tuning &amp; Operations<\/a>\r\n                                                    <ul class=\"sub-menu\">\r\n                                                        <li class=\"has-children\"><a href=\"perf.htm\">Performance<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"perf_guidelines.htm\">General Performance Guidelines<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"perf_alerts.htm\">Alerts<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"perf_monitor.htm\">Monitoring<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"perf_tuning.htm\">Tuning<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"perf_troubleshooting.htm\">Troubleshooting Performance<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"perf_resources.htm\">Performance Resources<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"monitor_server.htm\">Monitor Server Health<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"qs_lds_monitoring.html\">Quick Start:&#160;Monitor Disk Space<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"email.htm\">Configure Alerts and Subscriptions<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"config_smtp.htm\">Configure SMTP Setup<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"trouble_disk_space.htm\">Troubleshoot Disk Space Usage<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"adminview.htm\">Administrative Views<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"adminview_bucket.htm\">Pre-built Administrative Views<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"adminview_postgres.htm\">Create Custom Administrative Views<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"monitor_maintenance.htm\">Maintenance<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"db.htm\">Database Maintenance<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"maintenance.htm\">Server Maintenance<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"trouble.htm\">Troubleshooting<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"logs_working_with.htm\">Work with Log Files<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"unlicensed.htm\">Handle an Unlicensed Server<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"trouble_svc_unlicensed.htm\">Handle an Unlicensed VizQL Server Process<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"trusted_auth_trouble_cookie.htm\">Cookie Restriction Error<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"datasource_trouble.htm\">Troubleshoot Data Sources<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"subscribe_trouble.htm\">Troubleshoot Subscriptions<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"saml_trouble.htm\">Troubleshoot SAML<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"ssl_mutual_troubleshooting.htm\">Troubleshooting Mutual SSL Authentication<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"trusted_auth_trouble.htm\">Troubleshooting Trusted Authentication<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"extract_refresh_alert.htm\">Handle Extract Refresh Alerts<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"service_status_troubleshoot.htm\">Troubleshoot Server Processes<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"trouble_inconsistent_process_status.htm\">Troubleshoot Inconsistent Process Status<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"trouble_install_upgrade.htm\">Troubleshoot Install and Upgrade<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"trouble_desk_license_rpts.htm\">Troubleshoot Desktop License Reporting<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"trouble_disk_space.htm\">Troubleshoot Disk Space Usage<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"runas_troubleshoot.htm\">Troubleshoot Run As User<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"cmd_line_utilities.htm\">Command Line Utilities<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"reconfig_tabadmin.htm\">tabadmin<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"tabcmd.htm\">tabcmd<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"server_admin_reference.htm\">Reference<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"processes.htm\">The Tableau Server Processes<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"ports.htm\">Tableau Server Ports<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"users_manage_ad.htm\">User Management in Active Directory Deployment<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                    <\/ul>\r\n                                                <\/li>\r\n                                                <li class=\"has-children\"><a href=\"security.htm\">Security<\/a>\r\n                                                    <ul class=\"sub-menu\">\r\n                                                        <li class=\"has-children\"><a href=\"security_auth.htm\">Authentication<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"kerberos.htm\">Kerberos<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"saml.htm\">SAML<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"trusted_auth.htm\">Trusted Authentication<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"impers.htm\">SQL Server Impersonation<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"openid_auth.htm\">OpenID Connect<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"protected_auth.htm\">OAuth Data Connections<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"security_authorize.htm\">Authorization<\/a>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"security_data.htm\">Data Security<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"tabadmin_regenerate.htm\">Regenerate a Password for the PostgreSQL Repository<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                        <li class=\"has-children\"><a href=\"security_net.htm\">Network Security<\/a>\r\n                                                            <ul class=\"sub-menu\">\r\n                                                                <li><a href=\"clickjack_protection.htm\">Clickjack Protection in Tableau Server<\/a>\r\n                                                                <\/li>\r\n                                                                <li><a href=\"ssl.htm\">SSL<\/a>\r\n                                                                <\/li>\r\n                                                            <\/ul>\r\n                                                        <\/li>\r\n                                                        <li><a href=\"security_harden.htm\">Security Hardening Checklist<\/a>\r\n                                                        <\/li>\r\n                                                    <\/ul>\r\n                                                <\/li>\r\n                                            <\/ul>\r\n                                        <\/li>\r\n                                    <\/ul>\r\n                                <\/div><a class=\"menu-icon right-off-canvas-toggle\" href=\"#\"><span><\/span><\/a>\r\n                            <\/div>\r\n                        <\/section>\r\n                        <div class=\"nav-search row outer-row\">\r\n                            <form class=\"search\" action=\"#\">\r\n                                <div class=\"search-bar search-bar-container needs-pie\">\r\n                                    <input class=\"search-field needs-pie\" type=\"search\" placeholder=\"Search\" \/>\r\n                                    <div class=\"search-filter-wrapper\">\r\n                                        <div class=\"search-filter\">\r\n                                            <div class=\"search-filter-content\">\r\n                                                <ul>\r\n                                                    <li>All Files<\/li>\r\n                                                <\/ul>\r\n                                            <\/div>\r\n                                        <\/div>\r\n                                    <\/div>\r\n                                    <div class=\"search-submit-wrapper\" dir=\"ltr\">\r\n                                        <div class=\"search-submit\" title=\"Search\">\r\n                                        <\/div>\r\n                                    <\/div>\r\n                                <\/div>\r\n                            <\/form>\r\n                        <\/div>\r\n                    <\/nav>\r\n                    <aside class=\"right-off-canvas-menu\" data-mc-ignore=\"true\">\r\n                        <ul class=\"off-canvas-list\" data-mc-back-link=\"Back\" data-mc-css-tree-node-expanded=\"has-submenu\" data-mc-css-tree-node-collapsed=\"has-submenu\" data-mc-css-sub-menu=\"right-submenu\" data-mc-include-indicator=\"False\" data-mc-include-icon=\"False\" data-mc-include-parent-link=\"True\" data-mc-include-back=\"True\" data-mc-defer-expand-event=\"True\" data-mc-expand-event=\"click.fndtn.offcanvas\" data-mc-toc=\"True\">\r\n                        <\/ul>\r\n                    <\/aside>\r\n                    <section class=\"main-section\">\r\n                        <div class=\"row outer-row\" data-mc-content-body=\"True\">\r\n                            <div class=\"outer-padding\">\r\n                                <script src=\"Resources\/Code\/feedback.js\">\r\n                                <\/script>\r\n                                <div id=\"form-container\">\r\n                                    <form style=\"width:90%; float:left;\" id=\"first-form\"><span class=\"form-helpful-text form-visible\">Was this page helpful?<\/span>\r\n                                        <div class=\"form-helpful-radio form-visible\">\r\n                                            <input type=\"radio\" name=\"form-helpful-radio\" id=\"helpful-yes\" value=\"1\" onclick=\"submitRating();\">Yes<\/input>\r\n                                            <input type=\"radio\" name=\"form-helpful-radio\" id=\"helpful-no\" value=\"2\" onclick=\"submitRating();\">No<\/input>\r\n                                        <\/div>\r\n                                    <\/form><span id=\"frame-caption\" class=\"feedback-hidden\">Have a comment? Please leave it here.<\/span><span id=\"post-submit-msg\" class=\"feedback-hidden\"><b>Thanks for your feedback!<\/b><\/span>\r\n                                <\/div><span style=\"float:left;\"><div class=\"MCBreadcrumbsBox_0\"><a class=\"MCBreadcrumbsLink\" href=\"lp_webclient.htm\">User Guide<\/a><span class=\"MCBreadcrumbsDivider\"> &gt; <\/span><a class=\"MCBreadcrumbsLink\" href=\"web_author.htm\">Create Views and Dashboards<\/a><span class=\"MCBreadcrumbsDivider\"> &gt; <\/span><a class=\"MCBreadcrumbsLink\" href=\"web_author_environment.htm\">The Web Authoring Workspace<\/a><span class=\"MCBreadcrumbsDivider\"> &gt; <\/span><a class=\"MCBreadcrumbsLink\" href=\"calculations_calculatedfields.htm\">Calculated Fields<\/a><span class=\"MCBreadcrumbsDivider\"> &gt; <\/span><span class=\"MCBreadcrumbs\">Ad-Hoc Calculations<\/span><\/div><\/span>\r\n                                <br \/>\r\n                                <h1>Ad-Hoc Calculations<\/h1>\r\n                                <p>Ad-hoc calculations are calculations that you can create and update as you work with a field on a shelf in the view. Ad-hoc calculations are also known as type-in or in-line calculations.<\/p>\r\n                                <table style=\"width: 100%;mc-table-style: url('Resources\/TableStyles\/Basic-Border.css');\" class=\"TableStyle-Basic-Border\" cellspacing=\"0\">\r\n                                    <col style=\"width: 612px;\" class=\"TableStyle-Basic-Border-Column-Column1\" \/>\r\n                                    <col class=\"TableStyle-Basic-Border-Column-Column1\" \/>\r\n                                    <tbody>\r\n                                        <tr class=\"TableStyle-Basic-Border-Body-Body1\">\r\n                                            <td class=\"TableStyle-Basic-Border-BodyE-Column1-Body1\">\r\n                                                <p>Double-click on an existing field  to start editing.<\/p>\r\n                                            <\/td>\r\n                                            <td class=\"TableStyle-Basic-Border-BodyD-Column1-Body1\">\r\n                                                <img src=\"Img\/calc_adhoc1.png\" \/>\r\n                                                <p>&#160;<\/p>\r\n                                            <\/td>\r\n                                        <\/tr>\r\n                                        <tr class=\"TableStyle-Basic-Border-Body-Body1\">\r\n                                            <td class=\"TableStyle-Basic-Border-BodyE-Column1-Body1\">You can also double-click on an empty shelf or on an empty part of a shelf to create a new calculation.<\/td>\r\n                                            <td class=\"TableStyle-Basic-Border-BodyD-Column1-Body1\">\r\n                                                <img src=\"Img\/calc_adhoc2.png\" \/>\r\n                                                <p>&#160;<\/p>\r\n                                            <\/td>\r\n                                        <\/tr>\r\n                                        <tr class=\"TableStyle-Basic-Border-Body-Body1\">\r\n                                            <td class=\"TableStyle-Basic-Border-BodyE-Column1-Body1\">Type to update the expression, or drag new fields into the expression from the <span class=\"uicontrol\">Data<\/span> pane or elsewhere in the view.<\/td>\r\n                                            <td class=\"TableStyle-Basic-Border-BodyD-Column1-Body1\">\r\n                                                <img src=\"Img\/calc_adhoc3.png\" \/>\r\n                                                <p>&#160;<\/p>\r\n                                            <\/td>\r\n                                        <\/tr>\r\n                                        <tr class=\"TableStyle-Basic-Border-Body-Body1\">\r\n                                            <td class=\"TableStyle-Basic-Border-BodyB-Column1-Body1\">\r\n                                                <p data-mc-conditions=\"Product.webplatform\">Press Enter or click outside the expression to commit the expression, close the calculation, and update the view.<\/p>\r\n                                                <p data-mc-conditions=\"Product.webplatform\">Press Ctrl+Enter to commit the expression and update the view without closing the calculation.<\/p>\r\n                                            <\/td>\r\n                                            <td class=\"TableStyle-Basic-Border-BodyA-Column1-Body1\">\r\n                                                <img src=\"Img\/calc_adhoc4.png\" \/>\r\n                                                <p>&#160;<\/p>\r\n                                            <\/td>\r\n                                        <\/tr>\r\n                                    <\/tbody>\r\n                                <\/table>\r\n                                <p>Ad-hoc calculations are supported on the <span class=\"uicontrol\">Rows<\/span>, <span class=\"uicontrol\">Columns<\/span>, <span class=\"uicontrol\">Marks<\/span>, and <span class=\"uicontrol\">Measure Values<\/span> shelves; they are not supported on the <span class=\"uicontrol\">Filters <\/span>or <span class=\"uicontrol\">Pages <\/span>shelves.<\/p>\r\n                                <p class=\"note\"><b>Note<\/b>: Ad-hoc calculations are not named, but are saved when you close the workbook. If you want to save an ad-hoc calculation for use in other workbook sheets, copy it to the <span class=\"uicontrol\">Data<\/span> pane. You will be prompted to name the calculation. {On server it just deposits it w\/o rename prompt.} Once you name an ad-hoc calculation, it is the same as a calculation you created with the calculation editor, and is available on other sheets in the workbook. See <a href=\"calculations_calculatedfields_create.htm\" class=\"MCXref xref\">Create or Edit a Calculated Field<\/a><\/p>\r\n                                <div class=\"MCDropDown MCDropDown_Open dropDown\"><span class=\"MCDropDownHead dropDownHead\"><a href=\"javascript:void(0);\" class=\"MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_\"><img class=\"MCDropDown_Image_Icon\" src=\"Skins\/Default\/Stylesheets\/Images\/transparent.gif\" height=\"13\" width=\"16\" alt=\"Closed\" data-mc-alt2=\"Open\" \/>Multi-Line Ad-Hoc Calculations<\/a><\/span>\r\n                                    <div class=\"MCDropDownBody dropDownBody\">\r\n                                        <p>As you're typing an ad-hoc calculation, you can press Shift+Enter to start a new line. However, only the current line is ever visible in an ad-hoc calculation, so this can be confusing for anyone viewing or editing the calculation who has no way of knowing that it contains multiple lines. <\/p>\r\n                                        <p>The first line of a multi-line ad-hoc calculation can be a comment that serves as a title for the calculation. This is the only line that is visible on the shelf after the calculation is committed:<\/p><pre xml:space=\"preserve\">\/\/City and State<\/pre><pre xml:space=\"preserve\">[City] + ', ' + [State]<\/pre>\r\n                                    <\/div>\r\n                                <\/div>\r\n                                <div class=\"MCDropDown MCDropDown_Open dropDown\"><span class=\"MCDropDownHead dropDownHead\"><a href=\"javascript:void(0);\" class=\"MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_\"><img class=\"MCDropDown_Image_Icon\" src=\"Skins\/Default\/Stylesheets\/Images\/transparent.gif\" height=\"13\" width=\"16\" alt=\"Closed\" data-mc-alt2=\"Open\" \/>Ad-Hoc Calculations and Aggregation<\/a><\/span>\r\n                                    <div class=\"MCDropDownBody dropDownBody\">\r\n                                        <p>If Tableau determines that the expression you enter is a measure (that is, returns a number), it automatically adds an aggregation to the expression when you commit the expression. For example, if you type <code>DATEDIFF('day',[Ship Date],[Order Date])<\/code> in an ad-hoc calculation and then press Enter, what you will see is the following: <\/p><pre xml:space=\"preserve\">SUM(DATEDIFF('day',[Ship Date],[Order Date]))<\/pre>\r\n                                        <p>If you use a field that is already an aggregated field (for example, SUM([Profit])) in an ad-hoc calculation, the result is an aggregate calculation. For example, when you commit an ad-hoc calculation <code>SUM([Profit])\/SUM([Sales])<\/code>, the result is:<\/p><pre xml:space=\"preserve\">AGG(SUM([Profit])\/SUM([Sales]))<\/pre>\r\n                                    <\/div>\r\n                                <\/div>\r\n                                <div class=\"MCDropDown MCDropDown_Open dropDown\"><span class=\"MCDropDownHead dropDownHead\"><a href=\"javascript:void(0);\" class=\"MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_\"><img class=\"MCDropDown_Image_Icon\" src=\"Skins\/Default\/Stylesheets\/Images\/transparent.gif\" height=\"13\" width=\"16\" alt=\"Closed\" data-mc-alt2=\"Open\" \/>Ad-Hoc Calculations for Insight and Experimentation<\/a><\/span>\r\n                                    <div class=\"MCDropDownBody dropDownBody\">\r\n                                        <p>Typically you create ad-hoc calculations on-the-fly to do things like<\/p>\r\n                                        <ul>\r\n                                            <li value=\"1\">\r\n                                                <p>Test a hunch <\/p>\r\n                                            <\/li>\r\n                                            <li value=\"2\">\r\n                                                <p>Try a what-if scenario <\/p>\r\n                                            <\/li>\r\n                                            <li value=\"3\">\r\n                                                <p>Debug a complex calculation <\/p>\r\n                                            <\/li>\r\n                                        <\/ul>\r\n                                    <\/div>\r\n                                <\/div>\r\n                                <div class=\"MCDropDown MCDropDown_Open dropDown\"><span class=\"MCDropDownHead dropDownHead\"><a href=\"javascript:void(0);\" class=\"MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_\"><img class=\"MCDropDown_Image_Icon\" src=\"Skins\/Default\/Stylesheets\/Images\/transparent.gif\" height=\"13\" width=\"16\" alt=\"Closed\" data-mc-alt2=\"Open\" \/>Managing Ad-Hoc Calculations<\/a><\/span>\r\n                                    <div class=\"MCDropDownBody dropDownBody\">\r\n                                        <p>Use the following keystrokes to manage ad-hoc calculations.<\/p>\r\n                                        <ul>\r\n                                            <li value=\"1\">\r\n                                                <p>Double-click in an existing field on the <span class=\"uicontrol\">Rows<\/span>, <span class=\"uicontrol\">Columns<\/span>, <span class=\"uicontrol\">Marks<\/span>, or <span class=\"uicontrol\">Measure Values<\/span> shelf to open it as an ad-hoc calculation.<\/p>\r\n                                            <\/li>\r\n                                            <li value=\"2\">\r\n                                                <p>Double-click elsewhere on any of these shelves to create a new ad-hoc calculation from scratch.<\/p>\r\n                                            <\/li>\r\n                                            <li value=\"3\">\r\n                                                <p>Press Esc to cancel an ad-hoc calculation.<\/p>\r\n                                            <\/li>\r\n                                            <li value=\"4\">\r\n                                                <p>Press Enter to commit an ad-hoc calculation, which updates the view and closes the ad-hoc calculation. Press Ctrl+Enter  to commit the change and update the view without closing the ad-hoc calculation.<\/p>\r\n                                            <\/li>\r\n                                            <li value=\"5\">\r\n                                                <p>When you double-click a named field on a shelf to edit it, you are not changing the original named field. <\/p>\r\n                                            <\/li>\r\n                                        <\/ul>\r\n                                        <p>In addition, the following rules govern the use of ad-hoc calculations.<\/p>\r\n                                        <ul>\r\n                                            <li value=\"1\">\r\n                                                <p>Only one ad-hoc calculation can be open at a time.<\/p>\r\n                                            <\/li>\r\n                                            <li value=\"2\">\r\n                                                <p>If a field that has a geographic role or a fiscal year setting associated with it is added to an ad-hoc calculation, the ad-hoc calculation inherits that role or setting.<\/p>\r\n                                            <\/li>\r\n                                            <li value=\"3\">\r\n                                                <p>The right-click context menu for an ad-hoc calculation supports the same options that would be available for any other field in the view of the same type, including the ability to change aggregation, show a filter, or format. <\/p>\r\n                                            <\/li>\r\n                                            <li value=\"4\">\r\n                                                <p>Ad-hoc calculations are not available when you create groups, sets, hierarchies, or parameters.<\/p>\r\n                                            <\/li>\r\n                                            <li value=\"5\">\r\n                                                <p>Ad-hoc calculations are valid for creating trend lines, forecasts, and reference lines, bands, and distributions.<\/p>\r\n                                            <\/li>\r\n                                        <\/ul>\r\n                                    <\/div>\r\n                                <\/div>\r\n                                <div id=\"menu-sidebar\"><span class=\"menu-sidebar-heading\">Other articles in this section:<\/span>\r\n                                    <div id=\"menu-proxy\">\r\n                                        <ul class=\"menu _Skins_SiblingTopics\">\r\n                                            <li class=\"has-children\"><a href=\"calculations_calculatedfields.htm\">Calculated Fields<\/a>\r\n                                                <ul class=\"sub-menu\">\r\n                                                    <li><a href=\"calculations_calculatedfields_create.htm\">Create or Edit a Calculated Field<\/a>\r\n                                                    <\/li>\r\n                                                    <li><a href=\"calculations_calculatedfields_formulas.htm\">Create Formulas in Tableau<\/a>\r\n                                                    <\/li>\r\n                                                    <li><a href=\"calculations_calculatedfields_autocomplete.htm\">Auto-Completion for Formulas<\/a>\r\n                                                    <\/li>\r\n                                                    <li><a href=\"#\" class=\"selected\">Ad-Hoc Calculations<\/a>\r\n                                                    <\/li>\r\n                                                <\/ul>\r\n                                            <\/li>\r\n                                        <\/ul>\r\n                                    <\/div>\r\n                                    <img src=\"Resources\/Code\/onLoad.png\" onload=\"hideEmptyMenus();\" \/>\r\n                                <\/div>\r\n                                <p class=\"footer\">Tableau Server is a product of Tableau Software\u00AE. <a href=\"http:\/\/www.tableau.com\/legal\" target=\"blank\">Legal &amp; Privacy<\/a><\/p>\r\n                            <\/div>\r\n                        <\/div>\r\n                    <\/section><a class=\"exit-off-canvas\"><\/a>\r\n                <\/section>\r\n            <\/div>\r\n            <script>\/* <![CDATA[ *\/$(document).foundation();\/* ]]> *\/<\/script>\r\n        <\/div>\r\n    <\/body>\r\n<\/html>";

DOM.write(html);
var simplifiedBody = '';

var h1Tags = DOM.body.getElementsByTagName('h1');
var h2Tags = DOM.body.getElementsByTagName('h2');
var h3Tags = DOM.body.getElementsByTagName('h3');
var pTags = DOM.body.getElementsByTagName('p');
var tableTags = DOM.body.getElementsByTagName('table');

for (var i in h1Tags) {
    simplifiedBody += h1Tags[i].textContent;
}
for (var i in h2Tags) {
    simplifiedBody += h2Tags[i].textContent;
}
for (var i in h3Tags) {
    simplifiedBody += h3Tags[i].textContent;
}
for (var i in pTags) {
    simplifiedBody += pTags[i].textContent;
}
for (var i in tableTags) {
    simplifiedBody += tableTags[i].textContent;
}

PostConversion.Trace(simplifiedBody);
PostConversion.Trace('end Test DOM');

PostConversion.Trace('Test XMLHttpRequest');
var xhr = new ActiveXObject('Msxml2.XMLHTTP');
xhr.open('GET', 'http://www.example.org');
xhr.onload = function () {
    if(xhr.status == 200) {
        console.log('body : ' + xhr.responseText);
    } else {
        console.log('Error HTTP: ' + xhr.status + ' ' + xhr.statusText, 2);
    }
}
xhr.send();

PostConversion.Trace('end Test XMLHttpRequest');